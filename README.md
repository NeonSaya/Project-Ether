# Project Ether (VR osu! Player)

![Unity](https://img.shields.io/badge/Made%20with-Unity%202022.3%20LTS-black?style=flat&logo=unity)
![C#](https://img.shields.io/badge/Language-C%23-blue)
![Platform](https://img.shields.io/badge/Platform-VR%20(OpenXR)-green) 
![Status](https://img.shields.io/badge/Status-Alpha-orange)

**Project Ether** æ˜¯ä¸€ä¸ªåŸºäº Unity å¼€å‘çš„æ²‰æµ¸å¼ VR èŠ‚å¥æ¸¸æˆé¡¹ç›®ã€‚å®ƒçš„æ ¸å¿ƒç›®æ ‡æ˜¯å°†ç»å…¸çš„ `osu!` æ¸¸æˆä½“éªŒç§»æ¤åˆ°è™šæ‹Ÿç°å®ç©ºé—´ä¸­ï¼Œé€šè¿‡ç‹¬åˆ›çš„**"å…‰å­æŒ‡æŒ¥å®¶" (Photon Conductor)** äº¤äº’æœºåˆ¶ï¼Œå®ç°ä½ä½“èƒ½æ¶ˆè€—ã€é«˜æ²‰æµ¸æ„Ÿçš„éŸ³æ¸¸ä½“éªŒã€‚

> âš ï¸ **æ³¨æ„**ï¼šæœ¬é¡¹ç›®ç›®å‰å¤„äº **Alpha** å¼€å‘é˜¶æ®µã€‚

---

## ğŸ® æ ¸å¿ƒç†å¿µ (Core Concept)

ä¸åŒäºã€ŠBeat Saberã€‹çš„å¤§å¹…åº¦æŒ¥ç ï¼ŒProject Ether è¿½æ±‚çš„æ˜¯**"æŒ‡æŒ¥å®¶èˆ¬çš„ä¼˜é›…ä¸ç²¾å‡†"**ã€‚

* **Relax (è½»æ¾)**: æŠ›å¼ƒç‰©ç†æŒ‰é”®ä¸é«˜å¼ºåº¦æŒ¥åŠ¨ï¼Œé‡‡ç”¨å°„çº¿äº¤äº’ã€‚
* **Precision (ç²¾å‡†)**: å¤åˆ» `osu!` çš„æ ¸å¿ƒåˆ¤å®šé€»è¾‘ï¼Œåœ¨ VR ä¸­é‡ç°é«˜éš¾åº¦è°±é¢çš„å¿«æ„Ÿã€‚
* **Flow (å¿ƒæµ)**: æç®€ä¸»ä¹‰è§†è§‰é£æ ¼ï¼Œä¸“æ³¨äºéŸ³ä¹ä¸èŠ‚å¥æœ¬èº«ã€‚

---

## âœ¨ å½“å‰ç‰¹æ€§ (Features)

### âœ… å·²å®ç° (Implemented)

* #### **1. æ ¸å¿ƒç³»ç»Ÿ (Core System)**
    
    - **å…¨åŠŸèƒ½è§£æå™¨ (Full .osu Parser)**:
      - åŸºäº `osu-droid` é€»è¾‘é‡æ„çš„ C# è§£ææ ¸å¿ƒï¼Œæ”¯æŒ Metadata, General, Events, TimingPointsã€‚
      - **AR è‡ªåŠ¨è®¡ç®—**: å†…ç½®æ ‡å‡† osu! ç®—æ³•ï¼Œæ ¹æ® `ApproachRate` è‡ªåŠ¨è®¡ç®— `TimePreempt` (ç¼©åœˆæ—¶é—´) å’Œ `SpawnOffset`ã€‚
      - **æ•°æ®ä¿®å¤**: è‡ªåŠ¨æ£€æµ‹å¹¶ä¿®å¤æ»‘æ¡ Tick çš„ç›¸å¯¹æ—¶é—´æˆ³é—®é¢˜ï¼Œç¡®ä¿é€»è¾‘ä¸ç»å¯¹æ—¶é—´è½´å¯¹é½ã€‚
    - **ç©ºé—´æ˜ å°„ç®—æ³• (Coordinate Mapping)**:
      - å®ç°äº† `CoordinateMapper`ï¼Œå°† osu! çš„ 512x384 2D åƒç´ åæ ‡ç³»ï¼Œæ— æŸæ˜ å°„åˆ° VR ç©å®¶å‰æ–¹çš„ 3D æ‰‡å½¢æ›²é¢ä¸Šã€‚
    
    #### **2. è§†è§‰è¡¨ç° (Visuals & Rendering)**
    
    - **é«˜ä¿çœŸæ»‘æ¡æ¸²æŸ“ (High-Fidelity Slider Rendering)**:
      - **åŒå±‚ç½‘æ ¼ç”Ÿæˆ**: å®ç°äº† osu! é£æ ¼çš„æ»‘æ¡å¤–è§‚ï¼Œåº•å±‚ç”Ÿæˆå®½ç™½è¾¹æ¡† (Border)ï¼Œé¡¶å±‚ç”Ÿæˆæœ¬ä½“é¢œè‰² (Body)ã€‚
      - **åŠ¨æ€ Z è½´ç®¡ç†**: ç²¾ç¡®æ§åˆ¶ Noteã€Slider Bodyã€Border å’Œ Approach Circle çš„ Z è½´å±‚çº§ï¼Œå½»åº•è§£å†³äº† Z-Fighting (é—ªçƒ) é—®é¢˜ã€‚
    - **åŸç”Ÿé£æ ¼ç»„ä»¶**:
      - **å¹³é¢åŒ–ç¼©åœˆ (Flat Approach Circles)**: å¼ºåˆ¶ Z è½´ç¼©æ”¾é”å®šï¼Œåœ¨ VR 3D ç¯å¢ƒä¸­å®Œç¾å¤åˆ» 2D åŸä½œçš„â€œçº¸ç‰‡â€ç¼©åœˆè§†è§‰æ•ˆæœã€‚
      - **å®Œæ•´æ»‘æ¡ç»„ä»¶**: åŒ…å«æ»‘æ¡çƒ (Follow Ball)ã€æŠ˜è¿”ç®­å¤´ (Reverse Arrow) ä»¥åŠæ ¹æ® Span åŠ¨æ€æ˜¾ç¤ºçš„é€»è¾‘ã€‚
    
    #### **3. æ¸¸æˆæœºåˆ¶ (Gameplay & Mechanics)**
    
    - **Relax æ¨¡å¼äº¤äº’ (Raycast Interaction)**:
      - **æ‚¬åœåˆ¤å®š (Hover Gameplay)**: é‡‡ç”¨ osu! Relax æ¨¡å¼æœºåˆ¶ã€‚æ— éœ€æŒ‰é”®ï¼Œåªéœ€ä½¿ç”¨å…‰å‰‘/å°„çº¿ (Laser) æŒç»­æŒ‡å‘éŸ³ç¬¦å³å¯è§¦å‘åˆ¤å®šã€‚
      - **åŒè‰²æ¿€å…‰**: å·¦æ‰‹(è“) / å³æ‰‹(çº¢) ç‹¬ç«‹å°„çº¿æ£€æµ‹ã€‚
    - **é«˜ç²¾åº¦åˆ¤å®šé€»è¾‘ (Judgement Logic)**:
      - **éå¯¹ç§°åˆ¤å®šçª—å£**: å®ç°äº†ä¸¥æ ¼çš„åˆ¤å®šä¿æŠ¤ (ä¾‹å¦‚ `-5ms` åˆ° `+HitWindow`)ï¼Œé˜²æ­¢ç¼©åœˆæœªé‡åˆæ—¶çš„è¯¯è§¦/æ—©æ‰“ (Notelock prevention)ã€‚
      - **å¤æ‚æ»‘æ¡é€»è¾‘**:
        - **ä¸é”€æ¯æœºåˆ¶**: å‡»ä¸­æ»‘æ¡å¤´åä¿ç•™ç‰©ä½“ï¼Œå…è®¸ç©å®¶ç»§ç»­è·Ÿéšæ»‘æ¡çƒã€‚
        - **è¡¥æ•‘æœºåˆ¶**: å³ä½¿æ¼æ‰æ»‘æ¡å¤´ï¼Œåªè¦ä¸­é€”è¿½ä¸Šæ»‘æ¡çƒ (Tracking)ï¼Œä¾ç„¶å¯ä»¥åˆ¤å®šåç»­çš„ Tick å’Œ Endã€‚
        - **Tick/Repeat åˆ¤å®š**: å®Œæ•´æ”¯æŒæ»‘æ¡ä¸­é—´çš„ Tick å¾—åˆ†å’ŒæŠ˜è¿”ç‚¹åˆ¤å®šã€‚
    
    #### **4. è°ƒè¯•ä¸å·¥å…· (Debug & Tools)**
    
    - **å¯è§†åŒ–è°ƒè¯•é¢æ¿**: å®æ—¶æ˜¾ç¤ºè°±é¢å…ƒæ•°æ® (CS/AR/OD)ã€å½“å‰ DSP æ—¶é—´ã€å·²ç”Ÿæˆ/æ´»åŠ¨éŸ³ç¬¦æ•°é‡ã€‚
    - **Gizmos è¾…åŠ©**: åœ¨ç¼–è¾‘å™¨ä¸­ç»˜åˆ¶å°„çº¿æ£€æµ‹èŒƒå›´å’Œåˆ¤å®šçƒèŒƒå›´ã€‚

* [ ] ### ğŸ“… è¿‘æœªæ¥å¼€å‘ To-Do List (Next Steps)

  #### 1. æ ¸å¿ƒåé¦ˆ (Juice & Feel) - **ä¼˜å…ˆçº§æœ€é«˜**

  - [ ] **æ‰“å‡»éŸ³æ•ˆ (Hitsounds)**: åœ¨ `NoteController` å’Œ `SliderController` çš„ `OnHit` / `HitHead` / `Tick` å¤„æ’­æ”¾éŸ³æ•ˆï¼ˆNormal, Whistle, Finishï¼‰ã€‚è¿™æ˜¯éŸ³æ¸¸çš„çµé­‚ã€‚
  - [ ] **æ‰‹æŸ„éœ‡åŠ¨ (Haptics)**: VR éŸ³æ¸¸å¿…é¡»æœ‰è§¦è§‰åé¦ˆã€‚
    - *æç¤º*: ä½¿ç”¨ Unity XR çš„ `SendHapticImpulse`ã€‚å½“å°„çº¿ `OnRayHover` æˆ–åˆ¤å®šæˆåŠŸæ—¶ï¼Œç»™æ‰‹æŸ„ä¸€ä¸ªçŸ­ä¿ƒçš„éœ‡åŠ¨ã€‚
  - [ ] **è¿å‡»æ˜¾ç¤º (Combo Counter)**: åœ¨è§†é‡å‰æ–¹åšä¸€ä¸ªæ‚¬æµ® UIï¼Œæ˜¾ç¤ºå½“å‰çš„ Combo æ•°ã€‚Miss æ—¶ä¼šæœ‰ç¢è£‚æˆ–å˜çº¢çš„åŠ¨ç”»ã€‚
  - [ ] **åˆ†æ•°ä¸å‡†ç¡®ç‡ (Score & Accuracy)**: å®ç° `RhythmGameManager` ä¸­çš„è®¡åˆ†é€»è¾‘ï¼Œå¹¶åœ¨ UI ä¸Šæ˜¾ç¤ºï¼ˆ300 / 100 / 50 / Missï¼‰ã€‚

  #### 2. æ¸¸æˆé€»è¾‘è¡¥å…¨

  - [ ] **è½¬ç›˜ (Spinner) ä¿®å¤**: ä½ ä¹‹å‰ä¿®äº† Slider å’Œ HitCircleï¼Œåˆ«å¿˜äº† `SpinnerController`ã€‚å®ƒå¯èƒ½ä¹Ÿé¢ä¸´ AR æ—¶é—´è®¡ç®—é”™è¯¯æˆ–åˆ¤å®šé€»è¾‘çš„é—®é¢˜ï¼Œéœ€è¦æ£€æŸ¥ã€‚
  - [ ] **ç”Ÿå‘½å€¼ç³»ç»Ÿ (HP Drain)**: å®ç° osu! çš„æ‰è¡€æœºåˆ¶ï¼ˆä¸æ‰“ä¼šæ‰è¡€ï¼Œæ‰“ä¸­å›è¡€ï¼Œæ‰å…‰å¤±è´¥ï¼‰ã€‚
  - [ ] **æ¸¸æˆç»“æŸç»“ç®—**: å½“æ­Œæ›²æ”¾å®Œæˆ– HP å½’é›¶æ—¶ï¼Œå¼¹å‡ºä¸€ä¸ªç»“ç®—é¢æ¿æ˜¾ç¤ºæˆç»©ã€‚

  #### 3. åŸºç¡€è®¾æ–½

  - [ ] **é€‰æ­Œèœå• (Song Select)**: ç›®å‰æ˜¯ç¡¬ç¼–ç åŠ è½½ `map.osu`ã€‚
  - [ ] **å¯¹è±¡æ±  (Object Pooling)**: ç›®å‰ä½ æ˜¯ `Instantiate` å’Œ `Destroy`ã€‚å¯¹äºéŸ³æ¸¸æ¥è¯´ï¼Œç”Ÿæˆå¤§é‡ Note ä¼šå¯¼è‡´ GC å¡é¡¿ã€‚éœ€è¦å®ç°ä¸€ä¸ªå¯¹è±¡æ± æ¥å¤ç”¨ Note å’Œ Sliderã€‚

---

## ğŸ› ï¸ æŠ€æœ¯æ¶æ„ (Architecture)

æœ¬é¡¹ç›®é‡‡ç”¨æ¨¡å—åŒ–æ¶æ„è®¾è®¡ï¼Œæ ¸å¿ƒè„šæœ¬ç»“æ„å¦‚ä¸‹ï¼š

```text
Assets/Scripts/
â”œâ”€â”€ TestLoader.cs               # è°ƒè¯•ä¸æµ‹è¯•åœºæ™¯å…¥å£
â”œâ”€â”€ Core/
â”‚   â”œâ”€â”€ RhythmGameManager.cs    # æ ¸å¿ƒæ¸¸æˆå¾ªç¯æ§åˆ¶å™¨ (è´Ÿè´£è°ƒåº¦)
â”‚   â”œâ”€â”€ CoordinateMapper.cs     # ç©ºé—´æ˜ å°„ç³»ç»Ÿ (2Dåƒç´ åæ ‡ -> VRæ›²é¢åæ ‡)
â”‚   â”œâ”€â”€ NoteController.cs       # å•ç‚¹ (HitCircle) ç‰©ä½“è¡Œä¸ºæ§åˆ¶å™¨
â”‚   â”œâ”€â”€ SliderController.cs     # æ»‘æ¡ (Slider) ç‰©ä½“è¡Œä¸ºæ§åˆ¶å™¨
â”‚   â”œâ”€â”€ SpinnerController.cs    # è½¬ç›˜ (Spinner) ç‰©ä½“è¡Œä¸ºæ§åˆ¶å™¨
â”‚   â””â”€â”€ Math/
â”‚       â””â”€â”€ SliderPathCalculator.cs # æ»‘æ¡æ›²çº¿ç”Ÿæˆç®—æ³• (Bezier, Catmullç­‰)
â”œâ”€â”€ Data/
â”‚   â”œâ”€â”€ OsuParser.cs            # .osu æ–‡ä»¶è§£ææ ¸å¿ƒ
â”‚   â”œâ”€â”€ Beatmap.cs              # å®Œæ•´è°±é¢æ•°æ®æ¨¡å‹
â”‚   â”œâ”€â”€ Enums.cs                # å…¨å±€æšä¸¾å®šä¹‰ (HitObjectType, CurveTypeç­‰)
â”‚   â”œâ”€â”€ HitObject.cs            # éŸ³ç¬¦æ•°æ®åŸºç±»
â”‚   â”œâ”€â”€ HitCircle.cs            # å•ç‚¹æ•°æ®å®šä¹‰
â”‚   â”œâ”€â”€ SliderObject.cs         # æ»‘æ¡æ•°æ®å®šä¹‰
â”‚   â”œâ”€â”€ SliderPath.cs           # æ»‘æ¡è·¯å¾„æ•°æ®ç»“æ„
â”‚   â””â”€â”€ SpinnerObject.cs        # è½¬ç›˜æ•°æ®å®šä¹‰
â””â”€â”€ Interaction/
    â””â”€â”€ LaserShooter.cs         # ç©å®¶å°„çº¿è¾“å…¥ä¸äº¤äº’åˆ¤å®šé€»è¾‘
```
---

## ğŸš€ å¿«é€Ÿå¼€å§‹ (Getting Started)

### ç¯å¢ƒè¦æ±‚

* Unity 2022.3.x LTS
* VR å¤´æ˜¾ (Quest 2/3, Pico 4 ç­‰) æˆ– XR Device Simulator

### å®‰è£…æ­¥éª¤

1. å…‹éš†æœ¬ä»“åº“ï¼š
    ```bash
    git clone https://github.com/NeonSaya/Project-Ether.git
    ```
2. ä½¿ç”¨ Unity Hub æ‰“å¼€é¡¹ç›®æ–‡ä»¶å¤¹ã€‚
3. **å¯¼å…¥è°±é¢**ï¼š
    * åœ¨ `Assets` ç›®å½•ä¸‹åˆ›å»ºä¸€ä¸ªåä¸º `Songs` çš„æ–‡ä»¶å¤¹ã€‚
    * å°†ä½ çš„ `.osu` æ–‡ä»¶æ”¾å…¥ `Assets/Songs/` ä¸­ã€‚
4. **é…ç½®ç®¡ç†å™¨**ï¼š
    * åœ¨åœºæ™¯ä¸­æ‰¾åˆ° `GameManager` ç‰©ä½“ã€‚
    * åœ¨ Inspector ä¸­å°† `Osu File Name` ä¿®æ”¹ä¸ºä½ æ”¾å…¥çš„è°±é¢æ–‡ä»¶åã€‚
5. ç‚¹å‡» **Play** è¿è¡Œï¼

---

## ğŸ•¹ï¸ æ“ä½œè¯´æ˜ (Controls)

| è®¾å¤‡ | åŠ¨ä½œ | æ•ˆæœ |
| :--- | :--- | :--- |
| **VR æ‰‹æŸ„** | ç§»åŠ¨/è½¬åŠ¨ | æ§åˆ¶çº¢è“å°„çº¿æŒ‡å‘ |
| **åˆ¤å®š** | å°„çº¿æ¥è§¦ | å½“éŸ³ç¬¦é£è¿‘æ—¶ï¼Œç”¨ä»»æ„é¢œè‰²çš„å°„çº¿æ‰«è¿‡éŸ³ç¬¦å³å¯è§¦å‘åˆ¤å®š |

---

## ğŸ¤ è‡´è°¢ (Credits)

* **osu! & peppy**: æœ¬é¡¹ç›®çš„çµæ„Ÿæ¥æºã€‚
* **osu-droid**: æœ¬é¡¹ç›®çš„è§£æé€»è¾‘å‚è€ƒäº†å…¶å¼€æºä»£ç ã€‚
* **Unity XR Interaction Toolkit**: æä¾› VR åº•å±‚æ”¯æŒã€‚

---

## ğŸ“„ License

MIT License
